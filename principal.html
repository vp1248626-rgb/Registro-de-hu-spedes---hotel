<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Principal - Registro de Huéspedes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #ffd152;
      --primary-dark: #e0b040;
      --secondary: #6c757d;
      --text-dark: #343a40;
      --bg-light: #f8f9fa;
      --white: #fff;
    }
    body { font-family: 'Poppins', sans-serif; background: var(--bg-light); color: var(--text-dark); }
    .navbar { background: var(--primary); padding: 1rem 0; box-shadow: 0 2px 5px rgba(0,0,0,.1); }
    .navbar-brand { font-weight: 700; font-size: 1.8rem; display: flex; align-items: center; color: var(--text-dark); }
    .navbar-brand img { height: 60px; width: 60px; margin-right: 15px; border-radius: 8px; object-fit: contain; }
    .navbar-right-buttons .btn { margin-left: 10px; transition: .3s; }
    .btn-custom-header { background: var(--primary-dark); border: var(--primary-dark); color: var(--text-dark); }
    .btn-custom-header:hover { background: #fdd867; border: #fdd867; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,.1); }
    .btn-exit { background: var(--secondary); border: var(--secondary); color: var(--white); }
    .btn-exit:hover { background: #5a6268; border: #5a6268; transform: translateY(-2px); }
    .card { margin-bottom: 30px; border: none; border-radius: 1rem; box-shadow: 0 0.75rem 1.5rem rgba(0,0,0,.1); overflow: hidden; }
    .card-header { background: var(--primary); color: var(--text-dark); font-size: 1.5rem; font-weight: 600; padding: 1.5rem 2rem; }
    .card-body { padding: 2rem; }
    .form-label { font-weight: 500; color: var(--text-dark); }
    .form-control { border-radius: .5rem; padding: .75rem 1rem; }
    .form-control:focus { border-color: var(--primary-dark); box-shadow: 0 0 0 .2rem rgba(255,209,82,.25); }
    .btn-primary { background: var(--primary); border: var(--primary); color: var(--text-dark); font-weight: 600; border-radius: .75rem; transition: .3s; }
    .btn-primary:hover { background: var(--primary-dark); border: var(--primary-dark); transform: translateY(-2px); }
    .table { background: var(--white); border-radius: 1rem; box-shadow: 0 0.75rem 1.5rem rgba(0,0,0,.1); margin-top: 1.5rem; }
    .table thead { background: var(--primary); color: var(--text-dark); }
    .table th, .table td { vertical-align: middle; padding: .75rem; font-size: .9rem; }
    .btn-action { font-size: .75rem; padding: .3rem .6rem; border-radius: .4rem; font-weight: 500; transition: .2s; min-width: 65px; }
    .btn-info { background: #17a2b8; border: #17a2b8; color: var(--white); }
    .btn-info:hover { background: #138496; border: #117a8b; }
    .btn-danger { background: #dc3545; border: #dc3545; color: var(--white); }
    .btn-danger:hover { background: #c82333; border: #bd2130; }
    .opinion-cell { max-height: 60px; overflow: hidden; -webkit-line-clamp: 3; -webkit-box-orient: vertical; display: -webkit-box; }
    .form-section-title { font-size: 1.2rem; font-weight: 600; color: var(--primary-dark); border-bottom: 2px solid var(--primary); margin: 1.5rem 0 1rem; padding-bottom: .5rem; }
    .form-search { background: var(--white); border-radius: .75rem; box-shadow: 0 .25rem .5rem rgba(0,0,0,.05); padding: 1.5rem; margin-bottom: 2rem; display: flex; gap: 1rem; align-items: center; }
    @media (max-width: 767.98px) { .col-md-6.border-end { border: none!important; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee; } }
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid px-4 d-flex justify-content-between align-items-center">
      <a class="navbar-brand" href="#"><img src="images/logotipo_hotel.png" alt="Logo Hotel">Registro de Huéspedes</a>
      <div class="navbar-right-buttons">
        <button class="btn btn-exit" onclick="salir()">Salir</button>
        <button class="btn btn-custom-header" onclick="location.href='nuevo_usuario.html'">Añadir usuario</button>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- Formulario -->
    <div class="card">
      <div class="card-header">Nuevo Registro de Huésped</div>
      <div class="card-body">
        <form onsubmit="registrarHuesped(event)">
          <div class="row">
            <div class="col-md-6 border-end">
              <h4 class="form-section-title">Datos Personales</h4>
              <input type="text" id="nombre" class="form-control mb-3" placeholder="Nombre" required>
              <input type="text" id="telefono" class="form-control mb-3" placeholder="Teléfono" required>
              <input type="email" id="correo" class="form-control mb-3" placeholder="Correo" required>
              <input type="text" id="empresa" class="form-control mb-3" placeholder="Empresa" required>
            </div>
            <div class="col-md-6">
              <h4 class="form-section-title">Datos de Estancia</h4>
              <input type="date" id="ingreso" class="form-control mb-3" required>
              <input type="date" id="salida" class="form-control mb-3" required>
              <input type="number" id="habitacion" class="form-control mb-3" placeholder="Habitación" required>
              <textarea id="opinion" class="form-control mb-4" rows="4" placeholder="Opinión / Comentarios" required></textarea>
            </div>
          </div>
          <button type="submit" class="btn btn-primary w-100">Registrar huésped</button>
        </form>
      </div>
    </div>

    <hr class="my-5">

    <!-- Tabla -->
    <div class="card">
      <div class="card-header">Lista de Huéspedes</div>
      <div class="card-body">
        <div class="form-search">
          <label for="busqueda" class="mb-0">Buscar:</label>
          <input type="text" id="busqueda" class="form-control" placeholder="Escribe el nombre..." oninput="mostrarHuespedes()">
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Nombre</th><th>Teléfono</th><th>Correo</th><th>Empresa</th>
                <th>Ingreso</th><th>Salida</th><th>Habitación</th><th>Opinión</th>
                <th class="text-center">Historial</th><th class="text-center">Eliminar</th>
              </tr>
            </thead>
            <tbody id="cuerpoTabla"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    let registros = JSON.parse(localStorage.getItem('registrosHuespedes')) || [];
    document.addEventListener('DOMContentLoaded', mostrarHuespedes);

    function guardarRegistros(){ localStorage.setItem('registrosHuespedes', JSON.stringify(registros)); }

    function registrarHuesped(e){
      e.preventDefault();
      const datos = ["nombre","telefono","correo","empresa","ingreso","salida","habitacion","opinion"]
        .reduce((acc,id)=>({...acc,[id]:document.getElementById(id).value}),{});
      registros.push(datos); guardarRegistros(); mostrarHuespedes(); e.target.reset();
    }

    function mostrarHuespedes(){
      const cuerpo = document.getElementById("cuerpoTabla"), filtro = busqueda.value.toLowerCase();
      cuerpo.innerHTML = "";
      const lista = registros.filter(h=>h.nombre.toLowerCase().includes(filtro));
      if(!lista.length){ 
        cuerpo.innerHTML = `<tr><td colspan="10" class="text-center text-muted py-3">No hay huéspedes ${filtro?"con ese nombre.":"registrados."}</td></tr>`;
        return;
      }
      lista.forEach(h=>{
        const i = registros.indexOf(h);
        cuerpo.innerHTML += `
          <tr>
            <td>${h.nombre}</td><td>${h.telefono}</td><td>${h.correo}</td><td>${h.empresa}</td>
            <td>${h.ingreso}</td><td>${h.salida}</td><td>${h.habitacion}</td>
            <td><div class="opinion-cell">${h.opinion}</div></td>
            <td class="text-center"><button class="btn btn-info btn-action" onclick="verHistorial('${h.nombre}')">Ver</button></td>
            <td class="text-center"><button class="btn btn-danger btn-action" onclick="eliminarHuesped(${i})">Eliminar</button></td>
          </tr>`;
      });
    }

    function eliminarHuesped(i){ 
      if(confirm("¿Eliminar este huésped?")){ registros.splice(i,1); guardarRegistros(); mostrarHuespedes(); }
    }
    function verHistorial(n){ localStorage.setItem("huespedHistorial", n); location.href="historial.html"; }
    function salir(){ location.href="login.html"; }
  </script>
</body>
</html>
